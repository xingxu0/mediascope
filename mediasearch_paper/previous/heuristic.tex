
\section{NP-Completeness and Heuristics}
\label{sec:heuri}

This scheduling optimization is an NPC complete problem. We give a greedy algorithm that may work here. First, sort the $\frac{N(N-1)}{2}$ similarity values. Second, assign each user $i$ a number bucket with capacity $s_{i}$, from the head of the pair queue, fill corresponding bucket with file id if any file hasn't get marked and bucket is not full, until all bucket get full. 

In practice, file size varies since we may need to upload different type of media, such as video clips, cropped image or resized image. So the above greedy algorithm may need some modification. Current idea for this problem is to give preference to different file type, and then change the previous number bucket to size bucket so the greedy process is nearly same.

Moreover, queries usually come randomly, which raises another multi-query processing demand for the system. In this situation, we propose a dynamic scheduling adjust algorithm here. To make explanation more clear, we begin with discussion of 2-query overlap scenario, assume the first query time is $[t_{1},t_{2}]$ and second query time is $[t_{3},t_{4}]$, , so the overlapping time is $OL=[max(t_{1},t_{3}),min(t_{2},t_{4})]$, to make discussion simple, we omit the schedule computing time, and add another metric called $rank$ when assign tasks to each user. For the files in the assigned task, we give them a rank, that requires uploading the highest rank file first. The rank is given based on the average similarity, the less similarity, the higher rank, and each file in the rank is associated with a ranking value represents its similarity between other files. Let's come back to the overlap design, during the overlapping time interval $OL$, those who have overlap, should follow the 2 rules: 1. upload overlap files(files that work for both queries), 2. delete from end of 2 ranking lists based on the ranking value, until satisfies  the overlap time consumption. Now, we give a solution to 2 queries scenario, it's easy to generalize to n-query scenario-just find the overlap time interval, and delete end of ranking list until satisfy the requirement. 